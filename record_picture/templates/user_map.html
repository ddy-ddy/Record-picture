{% extends 'base.html' %}



{% block aside %}
    <div style="display:block;margin:auto auto 0;padding:.5rem">
        <!--è®¾ç½®ç”¨æˆ·å-->
        <h3>{{ user_info.profile_name }}</h3>
        <!--è®¾ç½®ç”¨æˆ·å¤´åƒ-->
        <figure class="image">
            <img id="avatar" class="is-rounded" src="{{ user_info.picture_link }}"/>
        </figure>
    </div>
    <ul id="menu" class="menu-list">
        <li data-menuanchor="åœ°å›¾"><a href="{{ url_for("map") }}">åœ°å›¾ğŸ‡¨ğŸ‡³</a></li>
        <li data-menuanchor="æœç´¢ç…§ç‰‡ğŸ”"><a href="{{ url_for("search_pictures") }}">æœç´¢ç…§ç‰‡ğŸ”</a></li>
        <li data-menuanchor="æ‰€æœ‰ç…§ç‰‡"><a href="{{ url_for("show_all_pictures") }}">æ‰€æœ‰ç…§ç‰‡ğŸ†</a></li>
        <li data-menuanchor="ä¸Šä¼ ç…§ç‰‡"><a href="{{ url_for("upload") }}">ä¸Šä¼ ç…§ç‰‡â†‘</a></li>
        <li data-menuanchor="ä¸ªäººä¿¡æ¯"><a href="{{ url_for("user_index") }}">ä¸ªäººä¿¡æ¯ğŸ‘¨ğŸ»</a></li>
        <li data-menuanchor="ç™»å‡ºè´¦å·"><a href="{{ url_for("logout") }}">é€€å‡ºç™»é™†</a></li>
    </ul>
{% endblock %}


{% block content %}
    <div id="content">
        <div id="fullpage">
            <div class="is-flex is-flex-direction-column" style="height: 100%;">
                <!--+åœ°å›¾-->
                <div id="container_map"></div>
            </div>
        </div>
    </div>
{% endblock %}


{% block javascript %}
    <script type="text/javascript"
            src="https://webapi.amap.com/maps?v=1.4.15&key=ae7201c9d81da4c1a221f2f2452fd7aa&plugin=AMap.MarkerClusterer"></script>
    <script type="text/javascript">
        var cluster, markers = [];
        var map = new AMap.Map("container_map", {
            mapStyle: 'amap://styles/fresh', //è®¾ç½®åœ°å›¾çš„æ˜¾ç¤ºæ ·å¼
            center: [105, 34],      //åœ°å›¾æ˜¾ç¤ºä¸­å¿ƒ
            zoom: 5     //åœ°å›¾æ˜¾ç¤ºå¤§å°
        });
        var points = JSON.parse('{{ place_info | tojson | safe }}')
        AMap.plugin(['AMap.ToolBar', 'AMap.Scale', 'AMap.OverView'], function () {
            map.addControl(new AMap.ToolBar());
            map.addControl(new AMap.Scale());
            map.addControl(new AMap.MapType());
        })  //æ·»åŠ ç»„ä»¶
        //æ·»åŠ ç…§ç‰‡
        for (var i = 0; i < points.length; i += 1) {
            var url = points[i][1];
            markers.push(new AMap.Marker({
                position: points[i][0],
                content: '<div id = "for-img"><a href="' + url + '"' + ' ><img src="' + url + '"' + ' alt=""></div>',
                offset: new AMap.Pixel(-15, -15)
            }))
        }

        var sts = [{
            url: "https://a.amap.com/jsapi_demos/static/images/blue.png",
            size: new AMap.Size(32, 32),
            offset: new AMap.Pixel(-16, -16)
        }];

        cluster = new AMap.MarkerClusterer(map, markers, {
            styles: sts,
            gridSize: 80
        });
    </script>
{% endblock %}